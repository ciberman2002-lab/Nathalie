---
// src/pages/blog/[slug].astro mudado do que tem na maquina
import '../../styles/global.css';
import Header from '../../components/Header';
import Footer from '../../components/Footer';
import WhatsAppButton from '../../components/WhatsAppButton';
import Article from '../../components/Article';

import { getCollection } from 'astro:content';

// 1. Gera os caminhos estáticos durante o build (Essencial para Vercel Static)
export async function getStaticPaths() {
  const posts = await getCollection('artigos');
  return posts.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

// 2. Recupera os dados do post
const { entry } = Astro.props;

// 3. Renderiza o conteúdo Markdoc (.mdoc) para um componente Astro
const { Content } = await entry.render();

// 4. Mapeia os dados do Keystatic para o formato que seu componente Article espera
const post = {
  ...entry.data,
  content: Content,
};

---

<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{post.title} | Dra. Nathalie Almeida</title>
    <meta name="description" content={post.quote || 'Artigo jurídico especializado pela Dra. Nathalie Almeida'} />
    
    <meta property="og:title" content={post.title} />
    <meta property="og:description" content={post.quote} />
    <meta property="og:image" content={post.heroImage?.src} />
    <meta property="og:type" content="article" />
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com" rel="stylesheet">
  </head>

  <body class="bg-[#fdfbf7] selection:bg-[#4a0404] selection:text-white overflow-x-hidden">
    <Header client:load />

    <main class="pt-32 pb-24 max-w-5xl mx-auto px-6 paddingTopMobile">
      <Article
        client:load
        title={post.title}
        category={post.category}
        date={post.date}
        author={post.author}
        heroImage={post.heroImage}
        quote={post.quote}
        content={post.content}
        specialistNote={post.specialistNote}
        tags={post.tags}
        recommended={post.recommended}
      />
    </main>

    <Footer client:load />
    <WhatsAppButton client:idle />
  </body>
</html>


